# ===================================================
# REJOURNEY SELF-HOSTED PRODUCTION CONFIGURATION
# Example Environment File
# ===================================================
#
# Copy this file to .env.selfhosted in the project root and fill in your values.
# Or use: ./scripts/selfhosted/deploy.sh (auto-generates .env.selfhosted)
#
# IMPORTANT: Never commit .env.selfhosted to git - it contains secrets!

# ===================================================
# DOMAINS
# ===================================================
# Your domain names (must point to your server's IP)
DASHBOARD_DOMAIN=yourdomain.com
API_DOMAIN=api.yourdomain.com

# Public URLs (auto-generated from domains above)
PUBLIC_DASHBOARD_URL=https://yourdomain.com
PUBLIC_API_URL=https://api.yourdomain.com
PUBLIC_INGEST_URL=https://api.yourdomain.com
DASHBOARD_ORIGIN=https://yourdomain.com

# Let's Encrypt email for SSL certificate generation
LETSENCRYPT_EMAIL=admin@yourdomain.com

# ===================================================
# DATABASE
# ===================================================
# PostgreSQL credentials (auto-generated by deploy script)
POSTGRES_USER=rejourney
POSTGRES_PASSWORD=CHANGE_ME_GENERATE_SECURE_PASSWORD
POSTGRES_DB=rejourney
DATABASE_URL=postgresql://rejourney:CHANGE_ME_GENERATE_SECURE_PASSWORD@postgres:5432/rejourney

# ===================================================
# REDIS
# ===================================================
# Redis connection (auto-generated by deploy script)
REDIS_PASSWORD=CHANGE_ME_GENERATE_SECURE_PASSWORD
REDIS_URL=redis://:CHANGE_ME_GENERATE_SECURE_PASSWORD@redis:6379/0

# ===================================================
# S3 STORAGE
# ===================================================
# Choose one: Built-in MinIO (simpler) or External S3

# OPTION 1: Built-in MinIO (default, good for getting started)
USE_MINIO=true
MINIO_ROOT_USER=admin
MINIO_ROOT_PASSWORD=CHANGE_ME_GENERATE_SECURE_PASSWORD
S3_ENDPOINT=http://minio:9000
S3_PUBLIC_ENDPOINT=
S3_BUCKET=rejourney
S3_REGION=us-east-1
S3_ACCESS_KEY_ID=admin
S3_SECRET_ACCESS_KEY=CHANGE_ME_GENERATE_SECURE_PASSWORD

# OPTION 2: External S3 (AWS, Cloudflare R2, Hetzner, Wasabi, etc.)
# USE_MINIO=false
# S3_ENDPOINT=https://s3.us-east-1.amazonaws.com
# S3_PUBLIC_ENDPOINT=https://s3.us-east-1.amazonaws.com
# S3_BUCKET=your-bucket-name
# S3_REGION=us-east-1
# S3_ACCESS_KEY_ID=your-access-key-id
# S3_SECRET_ACCESS_KEY=your-secret-access-key

# Examples for different providers:
# AWS S3:           S3_ENDPOINT=https://s3.us-east-1.amazonaws.com
# Cloudflare R2:    S3_ENDPOINT=https://<account-id>.r2.cloudflarestorage.com
# Hetzner:          S3_ENDPOINT=https://fsn1.your-objectstorage.com
# Wasabi:           S3_ENDPOINT=https://s3.wasabisys.com

# ===================================================
# APPLICATION SECRETS
# ===================================================
# Generate these with: openssl rand -hex 32
# (Auto-generated by deploy script)
JWT_SECRET=CHANGE_ME_GENERATE_64_CHAR_HEX_STRING
JWT_SIGNING_KEY=CHANGE_ME_GENERATE_64_CHAR_HEX_STRING
INGEST_HMAC_SECRET=CHANGE_ME_GENERATE_64_CHAR_HEX_STRING

# Storage encryption key (for encrypting S3 secrets in database)
# Generate with: openssl rand -hex 32
# This encrypts S3 secret keys stored in the database
STORAGE_ENCRYPTION_KEY=CHANGE_ME_GENERATE_64_CHAR_HEX_STRING

# ===================================================
# OPTIONAL: EMAIL (for team invites, alerts)
# ===================================================
# Configure SMTP to enable email notifications and team invites
# Leave empty if you don't need email features
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_FROM=noreply@yourdomain.com
SMTP_SECURE=true

# Common SMTP providers:
# Gmail:        SMTP_HOST=smtp.gmail.com, SMTP_PORT=587
# SendGrid:     SMTP_HOST=smtp.sendgrid.net, SMTP_PORT=587
# Mailgun:      SMTP_HOST=smtp.mailgun.org, SMTP_PORT=587
# AWS SES:      SMTP_HOST=email-smtp.us-east-1.amazonaws.com, SMTP_PORT=587

# ===================================================
# OPTIONAL: GITHUB OAUTH
# ===================================================
# Enable GitHub OAuth login (optional)
# Create OAuth app at: https://github.com/settings/developers
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# ===================================================
# DOCKER
# ===================================================
# Docker image tag to use
IMAGE_TAG=latest

# ===================================================
# NOTES
# ===================================================
# 1. The deploy script (./scripts/selfhosted/deploy.sh) will
#    auto-generate all secrets and passwords for you.
#
# 2. For manual setup, replace all CHANGE_ME values with
#    secure random strings (use: openssl rand -hex 32)
#
# 3. Never commit this file or .env.selfhosted to git!
#
# 4. Back up .env.selfhosted securely - it contains all secrets.
#
# 5. For multi-S3 scaling, you can add multiple storage endpoints
#    via the database (storage_endpoints table) after initial setup.
#    Use the encrypt-s3-secret.mjs script to encrypt secrets:
#    node scripts/k8s/encrypt-s3-secret.mjs "your-s3-secret-key"
